---
Titanic Death Prediction Model
==============================
author: Peter

Setup
-----
Set working directory to place with files and load files
  setwd('C:/Users/Pete/titanic-kaggle')
  train <- read.csv("C:/Users/Pete/titanic-kaggle/train.csv")
  View(train)
  test <- read.csv("C:/Users/Pete/titanic-kaggle/test.csv")
  View(test)

First look at Data
------------------
Basic note: test has 418 observations and 11 variables.
train has 891 observations and 12 variables.
The 1 less variable is whether the passengers survived or not.
Create a model using train and then test the model to see who in "test" survived.

```{r}
str(train)
#3 data types here, int, num, and factor. int is integer, num is floating, and
#factor is a category, which can hold strings.
table(train$Survived)
#This outputs a table, row1 is [0,1], row2 is [549, 342]. as in 549 died and 342 survived
prop.table(table(train$Survived))
#Gives proportions, and we see that 61.61% of passengers died while 38.38% survived in the training set
```
1st Hypothesis
--------------
As a first prediction, since the majority of patients died in my train set, let us say everyone died.

```{r}
test$Survived <- rep(0,418)
```
This creates a new column called "Survived" and inputs 0 for 418 rows.
If a "Survived" column already existed, then the values would be replaced.
```{r}
submit <- data.frame(PassengerId = test$PassengerId, Survived = test$Survived)
#These words are case sensitive
write.csv(submit,file = "Titanic_Model.csv",row.names = FALSE)
#Create csv file using data frame and exclude row numbers
#Submission to Kaggle requires passengerID and Survived prediction, 2 columns with 418 observations.
```
Results from first submission:

Prediction score of: 0.62679
- - - -
Gender-Based analysis
---------------------
```{r}
summary(train$Sex)
#female 314, male 577
prop.table(table(train$Sex,train$Survived),1)
#The 1 makes it so that I get row-wise proportions, 2 gives column-wise proportions
#74% of females survived, while 81% of males died
```

```{r}
test$Survived <- 0
#Creates a whole column of 0
test$Survived[test$Sex == 'female'] <- 1
#From everyone died, change so that only men died. All women survived.
submit <- data.frame(PassengerId = test$PassengerId, Survived = test$Survived)
write.csv(submit,file = "Titanic_Model.csv",row.names = FALSE)
```

Prediction score of: 0.76555
- - - -
Age-based Analysis
------------------
```{r}
summary(train$Age)
#Mean of 29.70, with 177 NA's
train$Child <- 0
train$Child[train$Age <18] <- 1
#Create a new column to identify children, who are below 18, and assume they all survived.
aggregate(Survived ~ Child + Sex, data = train, FUN = sum)
#aggregate(target variable ~ subset variable, data frame, function)
#38 female children survived, 23 male children survived
aggregate(Survived ~ Child + Sex, data=train, FUN=length)
#Length of the vector. For example, child0sexfemale has survived length of 259
aggregate(Survived ~Child + Sex, data=train, FUN=function(x) {sum(x)/length(x)})
#this gives proportion of survival subset by children and sex
#More females survived, regardless of whether they were children or not, and so the original prediction that females always had a higher probability of surviving does not change.
```
Abandon Age-Based Analysis as is because it is fruitless.


Fare-Class-Based Analysis
-------------------------
```{r}
train$Fare2 <- '30+'
train$Fare2[train$Fare < 30 & train$Fare >= 20] <- '20-30'
train$Fare2[train$Fare < 20 & train$Fare >= 10] <- '10-20'
train$Fare2[train$Fare < 10] <- '<10'
#Fare is a continuous variable, and so create bins

aggregate(Survived~Fare2 + Pclass + Sex, data=train,FUN=function(x) {sum(x)/length(x)})
#Survival proportions based on gender, fare cost, and pclass
#Majority of males, regardless of class or fare died. However, most of the class 3 woomen who paid more than $20 also died. A hypothesis could be that these expensive cabins were located close to the iceberg impact site, or were further from the exit stairs.
```

```{r}
test$Survived <- 0
test$Survived[test$Sex == 'female'] <- 1
test$Survived[test$Sex == 'female' & test$Pclass == 3 & test$Fare >= 20] <- 0
submit <- data.frame(PassengerId = test$PassengerId,Survived = test$Survived)
write.csv(submit,file="Titanic_Model.csv",row.names=FALSE)
```
Over the previous model, females who are in class 3 and has a fare greater than 20 are assumed to die.
Thus far, I cut apart the data into component so that I could identify which group died and which did not.

Prediction score of: 0.77990
- - - -
